---
title: "LABORATÓRIO 1: Regressão Linear Simples"
author: Fernando Bispo
format:
      pdf:
        toc: true
        toc-title: Sumário
        colorlinks: true
        documentclass: report
        papersize: letter
        number-sections: false
        geometry:
          - top=30mm
          - left=30mm
          - right=20mm
          - bottom=20mm
          - heightrounded
        fig-pos: "H"
        fig-align: center
        lang: pt-BR
        # fontfamily: libertinus
        fontsize: 12pt
        include-in-header:
        - text: |
            \usepackage{caption}
            \usepackage{fontspec}
            \usepackage{xcolor}
            \usepackage{indentfirst}
            \captionsetup[table]{name=Tabela}
---

```{r pacotes}
#| echo: false
#| warning: false

if (!require(pacman)){
  install.packages("pacman")} else{
library(pacman)}

pacman::p_load(tidyverse,  janitor, summarytools, kableExtra)

summarytools::st_options(lang = "pt")

```

## Questão 1

Os dados disponibilizados pelo _California Standardized Testing and Reporting_ (STAR) contêm informações sobre performance de exames, características da escola e informações demográficas dos alunos. Os dados são provenientes de 428 escolas de ensino fundamental de distritos da Califórnia em 1998 e 1999. Os escores dos testes são médias dos escores de leitura e matemática em testes de _Stanford_ padronizados que foram administrados em estudantes da 5ª  série. Para as análises a serem feitas serão consideradas apenas as variáveis **MATH-SCR** (média do escore de matemática) e **STR** (razão do número de estudantes por professores:(ESTUD/PROF)


```{r dados1}
#| echo: false
#| warning: false

dados_brutos1 <- read.csv("dados/caschool.csv")

dados1 <- dados_brutos1|>
  janitor::clean_names()

head(dados1)|>
  kbl(
    caption = "Apresentação parcial do conjunto de dados.",
    format.args=list(big.mark=".", decimal.mark=","),
    align = "c", 
    row.names = F
  )|>
  kable_material(c("striped", "hover", "condensed"))

```


### Item a

```{r item_a}
#| echo: false
#| warning: false

dados1|>
  select(-observation_number)|> 
  summarytools::descr(
    stats = c("min", "q1", "med", "mean","q3", "max",  "sd", "cv"),
    justify = "c",
    style = "grid",
    transpose = T
  )|>
  kableExtra::kbl(
    caption = "Medidas tendência central e dispersão.",
    digits = 2,
    format.args=list(big.mark=".", decimal.mark=","),
    align = "c", 
    row.names = T,
    col.names =
      c("Min", "Q1", "Med", "Média", "Q3", "Max", "Desvio Padrão", "CV")
  )|>
  kable_material(c("striped", "hover", "condensed"),
    full_width = F,
  #   fixed_thead = T # Fixa o cadeçalho ao rolar a tadela.
  ) |> 
  footnote(general = "Fonte: California Standardized Testing and Reporting (STAR)") |>
  kable_material()

```

Com base na Tabela 1 se constata que os dados aparentam ter uma distribuição simétrica, tendo em vista o valor da Mediana ser Próximo ao da Média


### Item b

```{r item_b}
#| echo: false
#| warning: false
#| fig-height: 5
#| fig-width: 7


plot(dados1$math_scr, dados1$str, 
     # pch=23, 
     bty="n", cex=1.3, xlab="", ylab="")
box(bty="l")
title(main = "Diagrama de dispersão entre MATH-SCR e STR", 
      xlab = "MATH-SCR", ylab = "STR", 
      font.main = 3)
```

Visualmente falando, com base na Figura 1, não há uma relação aparente entre as variávereis, pois nenhuma tendência foi constatada.

### Item c

Sendo muitas vezes necessário a implementação/criação de funções próprias personalizadas para o estudo de determinados fenômenos que não estão disponíveis em pacotes, se faz necessário o aprimoramento dessa habilidade, para tanto segue a construção de uma função responsável por calcular o Desvio Padrão dos dados inseridos

```{r item_c}
# Criação da função:
dp = function(x){
  n = length(x)
  m = sum(x)/n
  desvio = (x - m)^2
  var = sum(desvio)/(n-1)
  dp = sqrt(var)
  
  return(dp)
}

# Desvio Padrão da variável MATH-SCR:
dp(dados1$math_scr)

# Desvio Padrão da variável STR:
dp(dados1$str)


```



### Item d

```{r item_d}
# Criação da função:
corr_pearson = function(x, y){
  n = length(x)
  soma_x = sum(x)
  soma_x2 = sum(x^2)
  s_xx = soma_x2-(((soma_x)^2)/n)
  
  soma_y = sum(y)
  soma_y2 = sum(y^2)
  s_yy = soma_y2-(((soma_y)^2)/n)
  
  soma_xy = sum(x*y)
  s_xy = soma_xy-((soma_x*soma_y)/n)
  
  r = s_xy/(sqrt(s_xx*s_yy))
  
  return(r)
}

corr_pearson(dados1$math_scr, dados1$str)

# Desvio Padrão da variável MATH-SCR:
dp(dados1$math_scr)

# Desvio Padrão da variável STR:
dp(dados1$str)


```
















## Questão 2

Para a resolução da segunda parte da atividade foi disponibilizado um conjunto de dados originalmente do _National Institute of Diabetes and Digestive and Kidney Diseases._ (Instituto Nacional de Diabetes e Doenças Digestivas e Renais). O objetivo do conjunto de dados é prever diagnosticamente se um paciente tem ou não diabetes, com base em determinadas medidas de diagnóstico incluídas no conjunto de dados. Várias restrições foram impostas à seleção dessas instâncias em um banco de dados maior. Em particular, todos os pacientes aqui são mulheres com pelo menos 21 anos de idade, de ascendência indígena Pima.


```{r dados2}
#| echo: false
#| warning: false

dados_brutos2 <- read.table('dados/pima.ascii', sep = " ")

head(dados_brutos2)|>
  kbl(
    caption = "Apresentação parcial do conjunto de dados.",
    format.args=list(big.mark=".", decimal.mark=","),
    align = "c", 
    row.names = F
  )|>
  kable_material(c("striped", "hover", "condensed"))
  # kable_material()

```

A fim de conhecer o conjunto de dados, segue a Tabela 2 contendo as principais medidas resumo do conjunto de dados disponibilizado.



```{r item_1 tab2}
#| echo: false
#| warning: false

# summary(dados_brutos2)

dados_brutos2|>
  summarytools::descr(
    stats = c("min", "q1", "med", "mean","q3", "max",  "sd", "cv"),
    # round.digits = 3,
    justify = "c",
    style = "grid",
    transpose = T
  )|>
  kbl(
    caption = "Medidas tendência central e dispersão.",
    digits = 2,
    format.args=list(big.mark=".", decimal.mark=","),
    align = "c", 
    row.names = T,
    col.names =
      c("Min", "Q1", "Med", "Média", "Q3", "Max", "Desvio Padrão", "CV")
  )|>
  kable_material(c("striped", "hover", "condensed"))|>
  # kadle_styling(
  #   # dootstrap_options = c("striped", "hover", "condensed", "responsive"),
  #   dootstrap_options = c("striped", "hover"),
  #   full_width = F,
  #   fixed_thead = T # Fixa o cadeçalho ao rolar a tadela.
  # ) %>%
  # footnote(general = "Fonte: Instituto Nacional de Diabetes e de Doenças Digestivas e Renais - EUA") |>
  kable_material()

```


Levando em consideração o fato de haverem muitos dados faltantes constatou-se que esses dados foram substituídos por valores zero, o que influencia negativamente na interpretação dos resultados das principais medidas resumo calculadas, logo essas observações serão removidas e novos cálculos serão realizados a fim de se obter medidas mais fidedignas da realidade.

É importante ressaltar que a variável _test_ é uma variável categórica, logo não faz sentido haver interpretações acerca das medidas resumo dessa variável, sendo expressa a Figura X para possibilitar uma melhor visualização do comportamento dessa variável.


```{r item2_dadosNA}
#| echo: false
#| warning: false


dados_brutos2$pregnant[dados_brutos2$pregnant == 0] = NA
dados_brutos2$glucose[dados_brutos2$glucose == 0] = NA
dados_brutos2$diastolic[dados_brutos2$diastolic == 0] = NA
dados_brutos2$triceps[dados_brutos2$triceps == 0] = NA
dados_brutos2$insulin[dados_brutos2$insulin == 0] = NA
dados_brutos2$bmi[dados_brutos2$bmi == 0] = NA
dados_brutos2$diabetes[dados_brutos2$diabetes == 0] = NA
dados_brutos2$age[dados_brutos2$age == 0] = NA
# dados_brutos2$test[dados_brutos2$test == 0] = NA
```



```{r item_1_tab3}
#| echo: false
#| warning: false

dados_brutos2|>
  summarytools::descr(
    stats = c("min", "q1", "med", "mean","q3", "max",  "sd", "cv"),
    justify = "c",
    style = "grid",
    transpose = T
  )|>
  kbl(
    caption = "Medidas Resumo para o sexo feminino.",
    digits = 2,
    format.args=list(big.mark=".", decimal.mark=","),
    align = "c", 
    row.names = T,
    col.names =
      c("Min", "Q1", "Med", "Média", "Q3", "Max", "Desvio Padrão", "CV")
  )|>
  kable_material(c("striped", "hover", "condensed"))

dados_brutos2$test = factor(dados_brutos2$test)

```




```{r item_5_fig3}
#| echo: false
#| warning: false
#| fig-height: 5
#| fig-width: 7

par(mfrow=c(2,4), las=1)
hist(dados_brutos2$pregnant, xlab="Pregnant", ylab="Frequência", main="")
hist(dados_brutos2$diastolic, xlab="Diastolic", ylab="Frequência", main="")
hist(dados_brutos2$triceps, xlab="Triceps", ylab="Frequência", main="")
hist(dados_brutos2$glucose, xlab="Glucose", ylab="Frequência", main="")
hist(dados_brutos2$insulin, xlab="Insulin", ylab="Frequência", main="")
hist(dados_brutos2$bmi, xlab="BMI", ylab="Frequência", main="")
hist(dados_brutos2$age, xlab="Age", ylab="Frequência", main="")
hist(dados_brutos2$diabetes, xlab="Diabetes", ylab="Frequência", main="")

```


### Item G
Construção de boxplots comparando a distribuiçãoas variáveis por grupo de resultado do teste de diabetes:





















